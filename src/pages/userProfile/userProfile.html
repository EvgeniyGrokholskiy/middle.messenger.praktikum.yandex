{{#>layouts/page title='User profile' }}
    <div class='user-profile_wrapper'>
        <div class='side-nav' onclick="location.href='../chat/chat.html'">
            {{> button/button class='button back-button' }}
        </div>
        <div class='user-profile_content'>
            {{> userProfileAvatar/userProfileAvatar imageSrc='' }}
            {{> h1/h1 text='Иван' class='user-profile_name font_16' }}
            <form name='user-profile' class='user-profile_setting-block'>
                {{#each userProfilePage.userProfileInputBlockData}}
                    {{> userProfileInputBlock/userProfileInputBlock this }}
                {{/each }}
                {{> button/button
                    type='button'
                    innerText='Сохранить'
                    class='form_button font_13 user-profile_save-button'
                }}
            </form>
            <form name='user-profile_password' class='user-profile_setting-block user-profile_change-password-block'>
                {{#each userProfilePage.userProfilePasswordBlock }}
                    {{> userProfileInputBlock/userProfileInputBlock this }}
                {{/each }}
                {{> button/button
                    type='button'
                    innerText='Сохранить'
                    class='form_button font_13 user-profile_password-save-button'
                }}
            </form>
            <div class='user-profile_setting-block user-profile_change-links'>
                {{#each userProfilePage.userProfileChangeLinks}}
                    {{> userProfileInputBlock/userProfileInputBlock this }}
                {{/each }}
                {{> button/button
                    onClick='location.href="/pages/chat/chat.html"'
                    innerText='Выйти'
                    class='user-profile_exit-button font_13 user-profile_save-password-button'
                }}
            </div>
            <div class='user-profile_avatar-load-popup-wrapper'>
                {{#> popup/popup class='user-profile_avatar-load-popup'}}
                    {{> addFile/addFile
                        isShowText='true'
                        text='Выбрать файл на компьютере'
                        accept='{{inputAccept.image}}'
                        isError=''
                    }}
                {{/popup/popup}}
            </div>
        </div>
        <script>
          const toggleUserName = () => {
            const userNameBlock = document.querySelector('.user-profile_name');
            userNameBlock?.classList.toggle('hide-user-name-block');
          };

          const toggleAddFilePopup = () => {
            const element = document.querySelector('.user-profile_avatar-load-popup-wrapper');
            element?.classList.toggle('avatar-load-popup-wrapper_open');
          };

          const toggleChangeUserData = () => {
            const inputs = document.querySelectorAll('input');
            const saveButton = document.querySelector('.user-profile_save-button');
            const buttonsBlock = document.querySelector('.user-profile_change-links');
            saveButton?.classList.toggle('show-block');
            buttonsBlock?.classList.toggle('hide-block');
            inputs?.forEach(input => input.toggleAttribute('disabled'));
            toggleUserName();
          };

          const toggleChangeUserPassword = () => {
            const buttonsBlock = document.querySelector('.user-profile_change-links');
            const settingsBlock = document.querySelector('.user-profile_setting-block');
            const passwordChangeBlock = document.querySelector('.user-profile_change-password-block');
            buttonsBlock?.classList.toggle('hide-block');
            settingsBlock?.classList.toggle('hide-block');
            passwordChangeBlock?.classList.toggle('show-block');
            toggleUserName();
          };

          document.addEventListener('DOMContentLoaded', () => {
            document.querySelector('.user-profile_avatar-load-popup-wrapper').addEventListener('click', toggleAddFilePopup);
            document.querySelector('.user-profile_avatar-wrapper').addEventListener('click', toggleAddFilePopup);
            document.querySelector('.user-profile_avatar-load-popup').addEventListener('click', (e) => e.stopPropagation());
            document.querySelector('.user-profile_change-data-button').addEventListener('click', toggleChangeUserData);
            document.querySelector('.user-profile_change-password-button').addEventListener('click', toggleChangeUserPassword);
            document.querySelector('.user-profile_save-button').addEventListener('click', toggleChangeUserData);
            document.querySelector('.user-profile_password-save-button').addEventListener('click', toggleChangeUserPassword);
          });
        </script>
    </div>
{{/layouts/page}}
